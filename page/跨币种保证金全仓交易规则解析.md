# 跨币种保证金全仓交易规则解析

本文详细解析了跨币种保证金全仓账户的交易规则、币种资产计算公式、自动和非自动借币模式下的交易逻辑以及风控措施。文中核心关键词包括 *跨币种保证金*、*全仓交易*、*自动借币*、*维持保证金*、*衍生品交易* 和 *风险控制*，可帮助您更好地理解和管理账户风险。

---

## 简介

在跨币种全仓账户模式下，您只需将资产转入交易账户，即可同时进行现货（含杠杆与非杠杆）、交割、永续和期权交易。各币种资产会统一折算为美元，用于校验下单、持仓保证金计算以及风险控制。当启用自动借币模式时，即使单一币种余额不足，只要整体美元价值充足，也可通过卖出现货或使用该币种作为结算币种交易合约来实现下单；若因超额卖出或亏损导致币种权益低于零，系统会自动产生负债并收取相应利息。

跨币种保证金模式下，全仓账户风险采用美元价值衡量。只要账户整体有效保证金（折合美元）充足，则所有仓位均能维持；否则，将触发减仓或强制平仓。此外，用户也可以选择逐仓模式，将各仓位风险进行隔离。

---

## 币种资产计算公式

### 主要术语及定义

| 名称               | 定义                                                                                         | 公式                                                                                      | 说明 |
| ------------------ | -------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------- | ---- |
| 余额               | 账户中某个币种在全仓中的资产余额                                                               | 无                                                                                        | details 数组中的 cashBal |
| 未平仓收益（全仓） | 该币种作为结算币种的所有全仓仓位收益总和                                                       | 全仓永续仓位收益 + 全仓交割仓位收益                                                        | N/A |
| 权益（全仓）       | 该币种在全仓中的资产权益                                                                     | 余额 + 未平仓收益（全仓） + 期权市值 – 全仓应扣未扣利息                                       | N/A |
| 占用权益           | 当前已被占用数量，包括现货及杠杆卖单、期权及逐仓挂单占用                                         | 现货及杠杆卖单占用 + 期权买入平仓挂单占用 + 逐仓挂单占用 + 交割/永续/期权挂单的预估手续费占用        | details 数组中的 frozenBal <br><br>*注：逐仓挂单成交后，相应币种权益会从全仓转至逐仓仓位。* |
| 可用权益           | 当前剩余可用于挂单及交易的权益                                                                 | Max[0, 权益（全仓） – 占用权益]                                                             | details 数组中的 availEq |
| 负债               | 全仓及逐仓杠杆仓位的负债（基于此值计算利息）                                                   | Abs{Min[0, 权益（全仓）]} + 逐仓杠杆仓位该币种负债                                          | details 数组中的 liab |
| 潜在借币           | 当币种权益不足以覆盖占用权益时产生的借币金额                                                   | Abs{Min[0, 权益（全仓） – 占用权益]}                                                        | N/A |
| 潜在借币保证金     | 潜在借币所产生的保证金（借币保证金基于币种杠杆倍数进行计算）                                     | 潜在借币 / 币种杠杆倍数 <br><br>*注：币种杠杆倍数可通过前端或 API 设定。*                    | details 数组中的 borrowFroz |

### 币种公式计算示例

假设您的账户中持有 BTC、SOL、USDT 等币种。现以 BTC-USDT 永续合约为例说明：

- 您以 80,000 USDT 的价格建立了 0.5 BTC 的多仓仓位，杠杆为 10 倍。若标记价格上升至 100,000 USDT，则未平仓收益为：  
  0.5 × (100,000 – 80,000) = 10,000 USDT。
  
- 假设 BTC 的杠杆倍数为 5 倍，并在现货交易对下卖出 4 个 BTC的挂单，导致 BTC 占用权益超过现有权益，从而产生潜在借币及其对应的保证金。

另外，重要概念包括有效保证金、仓位美元价值、占用保证金、可用保证金、维持保证金以及账户杠杆等，具体计算方式如下：

- **有效保证金**：账户中所有币种折合成法币的净值，可用于支持全仓挂单及仓位。  
  计算公式：折扣权益 + 现货及杠杆挂单损失 – 期权平仓挂单占用 – 逐仓挂单占用 – 所有挂单预估手续费  
  *注：折扣权益 = 各币种权益 × 现货美元价格 × 币种折扣率。*

- **adjEq（仓位美元价值）**：全仓仓位及潜在借币的美元价值总和。  
  计算方式根据合约类型（交割、永续、期权）及标记价格不同而异。

- **notionalUsd（未平仓收益，全仓）**：所有全仓仓位收益按美元指数折算的总和。

- **upl（占用保证金）**：账户中全仓持仓及挂单折合成法币后的总值。  
  公式：∑ [ (全仓挂单占用 + 全仓持仓占用 + 潜在借币占用) × 币种美元价格 ]  
  *注：全仓挂单占用包括交割合约、永续合约及卖出期权挂单的占用部分。*

- **imr（可用保证金）**：可用于交易现货及衍生品的保证金，计算：  
  有效保证金 + 交割/永续挂单损失 – 占用保证金  
  *注：挂单损失指成交时标记价格与预估成交价差异产生的未平仓亏损。*

- **维持保证金**：所有全仓持仓维持保证金的总和，计算公式为：  
  ∑ (全仓仓位维持保证金 × 币种价格)  
  *注：仓位维持保证金 = 仓位价值 × 维持保证金率。*

- **账户杠杆**：仓位美元价值与有效保证金的比例。

- **维持保证金率**：全仓账户风险的重要指标，表示为：  
  有效保证金 / (维持保证金 + 减仓手续费)  
  *注：减仓手续费按持仓数量及挂单数量计算。*

---

## 币种折扣率说明

在全仓模式中，各币种资产会折算成美元价值作为保证金。由于市场流动性不同，平台对不同币种设置了折扣率以降低风险。具体规则如下：

- **有 USD 指数的币种**：直接以币种的 USD 指数价格计价。  
- **无 USD 指数但有 USDT 现货交易的币种**：采用 USDT 现货价格乘以 USDT/USD 指数价格。  
- **无 USD 指数、USDT 现货，但有 BTC 现货的币种**：采用 BTC 现货价格乘以 BTC/USD 指数价格。  
- **无 USD 指数、USDT 和 BTC 现货，但有 ETH 现货的币种**：采用 ETH 现货价格乘以 ETH/USD 指数价格。

点击 [查看](https://bit.ly/OKXe) 获取当前币种折扣率设定。

---

## 账户公式计算示例

以具体数字说明：

- 折扣权益 = 2 × 0.98 × 100,000 + (4,000 × 0.95 + 2,000 × 0.9475) × 200 + 110,000 × 1 × 1  
  = 1,445,000 USD

- 假设您下了一笔占用 400,000 USD 的逐仓挂单，  
  则有效保证金 = 1,445,000 + 0 – 0 – 400,000 = 1,045,000 USD

- USDT 全仓持仓占用 = 0.5 × 100,000 / 10 = 50,000 USDT  
- BTC 潜在借币占用 = 2 / 5 = 0.4 BTC  
- 占用保证金 = 50,000 + 0.4 × 100,000 = 90,000 USD  
- 可用保证金 = 1,045,000 – 90,000 = 955,000 USD

---

## 交易规则说明

### 自动借币模式

#### 交易逻辑

用户可在设置中开启“自动借币”功能。在跨币种全仓自动借币模式下，无论是现货（含杠杆）、交割合约、永续合约还是期权交易，账户整体有效保证金需大于或等于挂单占用保证金。只要整体美元价值充足，即便单一币种可用余额或权益不足，也可实现下单并自动产生潜在借币。

#### 示例说明

| 账户 | 折扣权益    | 有效保证金    |
| ---- | ----------- | ------------- |
| USD  | 1,445,000   | 1,445,000     |

**下现货挂单示例**  
在 BTC/USDT 交易对中，若尝试卖出 120,000 USDT（价值 120,000 美元），订单不产生挂单损失。尽管账户有效保证金足额（1,445,000 美元），但若 USDT 可用权益仅为 100,000 USDT，自动借币模式可通过杠杆（例如5倍）使账户产生 20,000 USDT 的潜在借币及对应 4,000 USDT 的借币保证金。

**下合约挂单示例**  
在 BTCUSDT 永续合约中，下单做多的挂单占用保证金为 200,000 USDT，并产生 1,000 美元预估交易费。由于账户有效保证金充足，交易可以顺利完成。

---

### 非自动借币模式

在非自动借币模式下，账户进行交易时不仅要求整体有效保证金充足，还要求相应币种的**可用权益**（现货及杠杆交易时）或**可用余额**（逐仓开仓及期权买入时）满足订单需求。如果条件不满足，即使整体风险指标显示安全，也无法完成下单。

#### 示例说明

| 账户 | 折扣权益    | 有效保证金    |
| ---- | ----------- | ------------- |
| USD  | 1,445,000   | 1,445,000     |

**下现货挂单示例**  
在 BTC/USDT 交易对中下单卖出 120,000 USDT时，因账户只有 100,000 USDT 可用权益且处于非自动借币状态，订单将无法执行。

**下合约挂单示例**  
在 BTCUSDT 永续合约中，下单要求 100,000 USDT，并产生 500 USDT 的交易费。若币种的可用权益足以支付交易费，则订单可顺利成交。

---

### 潜在借币限额及免息额度说明

- 无论自动还是非自动借币模式，均可能产生潜在借币，该借币将占用杠杆梯度限额、主账户限额和平台总出借限额。
- 在全仓自动借币模式下，即使某币种余额或权益不足，只要整体美元价值充足，同样可通过卖出现货或使用该币种结算合约来生成潜在借币。若因此产生负债，用户将在免息额度内免收利息。
- 在全仓非自动借币模式下，用户只能使用实际的币种可用余额或权益下单；但跨币种账户中，由于各币种共同计算风险，某币种亏损时可能出现实际负债。免息额度内不收利息，超出则触发系统强制还币（FRP），详细规则请参阅 [自动换币机制规则介绍](https://bit.ly/OKXe)。

免息额度详细规则请点击 [查看](https://bit.ly/OKXe)。

---

## 风控措施

跨币种保证金模式设置了两级风险校验机制：**风控撤单校验**和**预减仓校验**，以确保在保证金不足时系统能自动进行挂单撤销或仓位减仓操作，防止出现因账户风险激增而引发的连锁反应。

### 风控撤单校验

- 当有效保证金低于仓位所需维持保证金、全仓开仓挂单初始保证金及挂单手续费总和时，系统会撤销所有交割合约、永续合约、期权合约的开仓单。  
- 在非自动借币模式下，如币种可用权益减去占用余额低于其所需保证金，系统将撤销增加占用的挂单，当可转余额小于 0 时，还会撤销所有逐仓开仓单、期权买单及卖出该币种的挂单。  
- 自动借币模式下，若币种真实借币额超出最大可借限额，将撤销所有可能增加真实借币的挂单。

### 预减仓校验

全仓强制减仓依据维持保证金率是否低于 100%触发。  
- 当全仓维持保证金率低于 300%时，系统会发送减仓预警提示。  
- 若维持保证金率低于或等于 100%，系统将依规则先撤销部分订单；若撤单后仍未恢复安全，账户将进入强制减仓阶段，分为三个阶段依次对不同类型仓位进行减仓。  
- 强制减仓时，系统会按当前标记价格将减仓操作转交给强平引擎，并收取相应维持保证金作为手续费；期权买方仓位不受影响。

在实际操作中，减仓策略会优先对风险更高、维持保证金占比较大的仓位进行处理。例如，若同一指数下存在多空对冲仓位，系统会首先减掉相反仓位；若对冲仓位全部减光，系统将根据风险改善程度依次减仓，直到账户风险指标恢复安全水平。

*风险提示：潜在借币及杠杆交易存在高风险，建议您密切关注维持保证金率，及时调整仓位或补充保证金。以上内容仅供参考，不构成任何投资建议，交易决策请基于自身财务状况谨慎选择。*

---
 

**总结：**本篇文章详细介绍了跨币种保证金全仓交易的相关规则、计算公式及风险控制措施，通过明确的示例和公式解析，帮助用户全面了解自动及非自动借币模式下的交易逻辑及风控机制。